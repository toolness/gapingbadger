<!DOCTYPE html>
<meta charset="utf-8">
<title>Gapingbadger Client</title>
<button id="login" style="display: none">Login</button>
<script src="js/require-config.js"></script>
<script src="js/require.min.js"></script>
<script>
var badger;

require([
  "jquery",
  "gapingbadger",
  "get-wiki-badges"
], function($, Gapingbadger, getWikiBadges) {
  getWikiBadges('/Webmakers/SampleBadges', function(badges) {
    console.log(badges);
  });
  badger = Gapingbadger("http://labs.toolness.com:3031");
  badger.on('auth-required', function() {
    require(["https://login.persona.org/include.js"], function() {
      $("#login").show().click(function() {
        navigator.id.get(badger.authenticate);
      });
    });
  });
  badger.on('authenticate', function() {
    console.log("AUTHENTICATED!", badger.email);
  });
  badger.on('fetch', function() {
    console.log('fetch');
  });
  badger.fetch();
});
</script>
